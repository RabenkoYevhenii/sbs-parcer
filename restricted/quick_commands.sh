#!/bin/bash
# Quick Commands for First Wave Campaign
# –ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–∞–º–ø–∞–Ω–∏–µ–π

echo "üöÄ FIRST WAVE CAMPAIGN - –ë–´–°–¢–†–´–ï –ö–û–ú–ê–ù–î–´"
echo "========================================"

# –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
cd "$(dirname "$0")"

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã–≤–æ–¥–∞ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è
separator() {
    echo ""
    echo "----------------------------------------"
    echo ""
}

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
confirm() {
    read -p "‚ùì $1 (y/N): " -n 1 -r
    echo
    [[ $REPLY =~ ^[Yy]$ ]]
}

# –ú–µ–Ω—é –±—ã—Å—Ç—Ä—ã—Ö –∫–æ–º–∞–Ω–¥
echo "–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:"
echo ""
echo "1. üîç –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã"
echo "2. üìä –û—Ç—á–µ—Ç –ø–æ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö"
echo "3. üéØ –ê–Ω–∞–ª–∏–∑ —Ü–µ–ª–µ–≤–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏"
echo "4. üß™ –¢–µ—Å—Ç–æ–≤–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ (3 –∫–æ–Ω—Ç–∞–∫—Ç–∞)"
echo "5. üöÄ –ü–æ–ª–Ω–∞—è –∫–∞–º–ø–∞–Ω–∏—è (—Ç–µ—Å—Ç + –æ—Ç–ø—Ä–∞–≤–∫–∞)"
echo "6. üìÅ –≠–∫—Å–ø–æ—Ä—Ç —Ü–µ–ª–µ–≤–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏"
echo "7. üßπ –û—á–∏—Å—Ç–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤"
echo "8. üìã –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤"
echo "9. üéõÔ∏è  –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é"
echo "0. üö™ –í—ã—Ö–æ–¥"
echo ""

read -p "‚û°Ô∏è –í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ–º–µ—Ä (0-9): " choice

case $choice in
    1)
        echo "üîç –ó–∞–ø—É—Å–∫ –ø–æ–ª–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏..."
        separator
        
        echo "üìã –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã:"
        python campaign_manager.py check
        
        separator
        echo "üìä –û–±—â–∏–π –æ—Ç—á–µ—Ç:"
        python campaign_manager.py report
        
        separator
        echo "üéØ –ê–Ω–∞–ª–∏–∑ —Ü–µ–ª–µ–≤–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏:"
        python campaign_manager.py analyze --target
        ;;
        
    2)
        echo "üìä –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞ –ø–æ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö..."
        separator
        
        if confirm "–ü–æ–∫–∞–∑–∞—Ç—å –¥–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç?"; then
            python campaign_manager.py report --detailed
        else
            python campaign_manager.py report
        fi
        ;;
        
    3)
        echo "üéØ –ê–Ω–∞–ª–∏–∑ —Ü–µ–ª–µ–≤–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏..."
        separator
        python campaign_manager.py analyze --target
        
        if confirm "–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ü–µ–ª–µ–≤—É—é –∞—É–¥–∏—Ç–æ—Ä–∏—é –≤ CSV?"; then
            python campaign_manager.py export
        fi
        ;;
        
    4)
        echo "üß™ –¢–µ—Å—Ç–æ–≤–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π..."
        separator
        
        read -p "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ—Å—Ç–æ–≤—ã—Ö –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 3): " test_limit
        test_limit=${test_limit:-3}
        
        if confirm "–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç –Ω–∞ $test_limit –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤?"; then
            python first_wave_campaign.py --test-only --test-limit $test_limit
        fi
        ;;
        
    5)
        echo "üöÄ –ü–æ–ª–Ω–∞—è –∫–∞–º–ø–∞–Ω–∏—è..."
        separator
        
        echo "‚ö†Ô∏è  –í–ù–ò–ú–ê–ù–ò–ï: –ë—É–¥–µ—Ç –∑–∞–ø—É—â–µ–Ω–∞ –ø–æ–ª–Ω–∞—è –∫–∞–º–ø–∞–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π!"
        echo "–°–Ω–∞—á–∞–ª–∞ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω —Ç–µ—Å—Ç, –∑–∞—Ç–µ–º –æ—Å–Ω–æ–≤–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞."
        echo ""
        echo "–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º –∞–∫–∫–∞—É–Ω—Ç–æ–≤:"
        echo "1. üë• –ú—É–ª—å—Ç–∏-–∞–∫–∫–∞—É–Ω—Ç (messenger1 + messenger2, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)"
        echo "2. üë§ –û–¥–∏–Ω –∞–∫–∫–∞—É–Ω—Ç (—Ç–æ–ª—å–∫–æ messenger1)"
        echo ""
        
        read -p "–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º (1-2): " account_mode
        
        campaign_cmd="python first_wave_campaign.py"
        if [ "$account_mode" = "2" ]; then
            campaign_cmd="$campaign_cmd --single-account"
            echo "‚úÖ –ë—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –æ–¥–∏–Ω –∞–∫–∫–∞—É–Ω—Ç"
        else
            echo "‚úÖ –ë—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –º—É–ª—å—Ç–∏-–∞–∫–∫–∞—É–Ω—Ç"
        fi
        
        if confirm "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å –ø–æ–ª–Ω–æ–π –∫–∞–º–ø–∞–Ω–∏–µ–π?"; then
            $campaign_cmd
        fi
        ;;
        
    6)
        echo "üìÅ –≠–∫—Å–ø–æ—Ä—Ç —Ü–µ–ª–µ–≤–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏..."
        separator
        
        timestamp=$(date +"%Y%m%d_%H%M%S")
        output_file="data/target_audience_$timestamp.csv"
        
        echo "–≠–∫—Å–ø–æ—Ä—Ç –≤ —Ñ–∞–π–ª: $output_file"
        
        if confirm "–ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ?"; then
            python campaign_manager.py export -o "$output_file"
        else
            python campaign_manager.py export -o "$output_file" --no-filters
        fi
        ;;
        
    7)
        echo "üßπ –û—á–∏—Å—Ç–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤..."
        separator
        
        echo "–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ (—Ä–µ–∂–∏–º –ø—Ä–æ—Å–º–æ—Ç—Ä–∞):"
        python campaign_manager.py cleanup
        
        separator
        if confirm "–í—ã–ø–æ–ª–Ω–∏—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤?"; then
            python campaign_manager.py cleanup --no-dry-run
        fi
        ;;
        
    8)
        echo "üìã –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤..."
        separator
        
        log_file="data/first_wave_campaign.log"
        
        if [ -f "$log_file" ]; then
            echo "–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ —Å –ª–æ–≥–æ–º:"
            echo "1. –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫"
            echo "2. –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –æ—à–∏–±–∫–∏"
            echo "3. –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –æ—Ç–ø—Ä–∞–≤–∫–∏"
            echo "4. –°–ª–µ–¥–∏—Ç—å –∑–∞ –ª–æ–≥–æ–º –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏"
            echo ""
            
            read -p "–í—ã–±–µ—Ä–∏—Ç–µ (1-4): " log_choice
            
            case $log_choice in
                1)
                    echo "üìú –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫ –ª–æ–≥–∞:"
                    tail -50 "$log_file"
                    ;;
                2)
                    echo "‚ùå –û—à–∏–±–∫–∏ –≤ –ª–æ–≥–µ:"
                    grep -i "error\|failed\|exception" "$log_file" | tail -20
                    ;;
                3)
                    echo "üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏:"
                    echo "–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ:"
                    grep -c "‚úÖ.*–æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ" "$log_file" 2>/dev/null || echo "0"
                    echo "–û—à–∏–±–æ–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏:"
                    grep -c "‚ùå.*–æ—à–∏–±–∫–∞" "$log_file" 2>/dev/null || echo "0"
                    ;;
                4)
                    echo "üëÅÔ∏è  –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–∞ (Ctrl+C –¥–ª—è –≤—ã—Ö–æ–¥–∞):"
                    tail -f "$log_file"
                    ;;
            esac
        else
            echo "‚ùå –õ–æ–≥ —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω: $log_file"
            echo "–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–∞–º–ø–∞–Ω–∏—é –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ª–æ–≥–∞."
        fi
        ;;
        
    9)
        echo "üéõÔ∏è –ó–∞–ø—É—Å–∫ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –º–µ–Ω—é..."
        separator
        python launch_campaign.py
        ;;
        
    0)
        echo "üëã –î–æ —Å–≤–∏–¥–∞–Ω–∏—è!"
        exit 0
        ;;
        
    *)
        echo "‚ùå –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –≤—ã–±–æ—Ä: $choice"
        echo "–í—ã–±–µ—Ä–∏—Ç–µ —á–∏—Å–ª–æ –æ—Ç 0 –¥–æ 9"
        exit 1
        ;;
esac

separator
echo "‚úÖ –ö–æ–º–∞–Ω–¥–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞!"

# –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π
echo ""
echo "üí° –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:"
echo "‚Ä¢ python campaign_manager.py --help  - —Å–ø—Ä–∞–≤–∫–∞ –ø–æ –º–µ–Ω–µ–¥–∂–µ—Ä—É"
echo "‚Ä¢ python first_wave_campaign.py --help  - —Å–ø—Ä–∞–≤–∫–∞ –ø–æ –∫–∞–º–ø–∞–Ω–∏–∏"
echo "‚Ä¢ python launch_campaign.py  - –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é"
echo ""
echo "üìÅ –í–∞–∂–Ω—ã–µ —Ñ–∞–π–ª—ã:"
echo "‚Ä¢ data/SBC - Attendees.csv  - –æ—Å–Ω–æ–≤–Ω–∞—è –±–∞–∑–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤"
echo "‚Ä¢ data/first_wave_campaign.log  - –¥–µ—Ç–∞–ª—å–Ω—ã–π –ª–æ–≥"
echo "‚Ä¢ data/first_wave_results.csv  - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç–ø—Ä–∞–≤–∫–∏"
echo ""

read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è..."
