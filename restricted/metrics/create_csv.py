#!/usr/bin/env python3
"""
–°–æ–∑–¥–∞—Ç—å –ø—É—Å—Ç–æ–π CSV —Ñ–∞–π–ª –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏
"""

import pandas as pd
import os


def create_empty_csv():
    """–°–æ–∑–¥–∞—Ç—å –ø—É—Å—Ç–æ–π CSV —Ñ–∞–π–ª —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –∫–æ–ª–æ–Ω–æ–∫"""

    # Ensure data directory exists
    data_dir = "data"
    os.makedirs(data_dir, exist_ok=True)

    csv_file = os.path.join(data_dir, "daily_statistics.csv")

    # Define the columns in Russian
    columns = [
        "–î–∞—Ç–∞",  # –î–∞—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ YYYY-MM-DD
        "–ù–æ–≤—ã—Ö –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤",  # –í—Å–µ–≥–æ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ —Å–æ–±—Ä–∞–Ω–æ –∑–∞ –¥–µ–Ω—å
        "–ü—Ä–æ–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞–Ω—ã—Ö",  # –ö–æ–Ω—Ç–∞–∫—Ç–æ–≤ –ø—Ä–æ—à–µ–¥—à–∏—Ö —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é
        "–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –°–æ–æ–±—â–µ–Ω–∏–π",  # –°–æ–æ–±—â–µ–Ω–∏–π –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –∑–∞ –¥–µ–Ω—å
        "–û—Ç–≤–µ—Ç–∏–ª–∏",  # –°–æ–æ–±—â–µ–Ω–∏–π —Å –ø–æ–ª—É—á–µ–Ω–Ω—ã–º–∏ –æ—Ç–≤–µ—Ç–∞–º–∏
        "–î–∞–Ω–∏–∏–ª",  # –°–æ–æ–±—â–µ–Ω–∏–π –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –î–∞–Ω–∏–ª–æ–º
        "–Ø—Ä–æ—Å–ª–∞–≤",  # –°–æ–æ–±—â–µ–Ω–∏–π –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –Ø—Ä–æ—Å–ª–∞–≤–æ–º
        "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ follow_up",  # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ follow-up —Å–æ–æ–±—â–µ–Ω–∏–π
        "–î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ follow_up",  # –î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ follow-up
        "% –í–∞–ª–∏–¥–Ω—ã—Ö",  # –ü—Ä–æ—Ü–µ–Ω—Ç –≤–∞–ª–∏–¥–Ω—ã—Ö –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ (–≤–∞–ª–∏–¥–Ω—ã–µ/—Å–æ–±—Ä–∞–Ω–Ω—ã–µ)
        "% –û—Ç–≤–µ—Ç–∏–≤—à–∏—Ö",  # –ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç–≤–µ—Ç–∏–≤—à–∏—Ö (–æ—Ç–≤–µ—Ç—ã/–æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ)
        "% –î–∞–Ω–∏–∏–ª",  # –ü—Ä–æ—Ü–µ–Ω—Ç —Å–æ–æ–±—â–µ–Ω–∏–π –î–∞–Ω–∏–ª–∞
        "% –Ø—Ä–æ—Å–ª–∞–≤",  # –ü—Ä–æ—Ü–µ–Ω—Ç —Å–æ–æ–±—â–µ–Ω–∏–π –Ø—Ä–æ—Å–ª–∞–≤–∞
    ]

    # Create empty DataFrame with proper columns
    df = pd.DataFrame(columns=columns)

    # Save to CSV
    df.to_csv(csv_file, index=False)

    print("üéâ CSV —Ñ–∞–π–ª —Å–æ–∑–¥–∞–Ω —É—Å–ø–µ—à–Ω–æ!")
    print(f"üìÑ –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ñ–∞–π–ª–∞: {csv_file}")
    print(f"üìã –°–æ–∑–¥–∞–Ω–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏:")
    for i, col in enumerate(columns, 1):
        print(f"   {i}. {col}")

    print(f"\nüí° –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ:")
    print(f"   ‚Ä¢ –ó–∞–ø—É—Å—Ç–∏—Ç—å 'python analytics.py' –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã–º–∏")
    print(
        f"   ‚Ä¢ –ó–∞–ø—É—Å—Ç–∏—Ç—å 'python add_daily_stats.py' –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å–µ–π –≤—Ä—É—á–Ω—É—é"
    )
    print(
        f"   ‚Ä¢ –ó–∞–ø—É—Å—Ç–∏—Ç—å 'python view_stats.py' –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–µ–∫—É—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö"
    )

    # Show example of how to add data
    print(f"\nüìù –ü—Ä–∏–º–µ—Ä –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:")
    print(f"   python add_daily_stats.py 2025-09-06 250 80 60 8")

    return csv_file


def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è"""
    try:
        # Change to script directory
        script_dir = os.path.dirname(os.path.abspath(__file__))
        os.chdir(script_dir)

        create_empty_csv()
        return 0

    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è CSV —Ñ–∞–π–ª–∞: {e}")
        return 1


if __name__ == "__main__":
    exit(main())
